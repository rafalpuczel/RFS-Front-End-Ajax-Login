!function(a,e,t,o){"use strict";var r={utils:{formData:function(e){var t={},o=e.parent().attr("id");return e.find(".form-control").each(function(e,o){var r=a(o),s=r.attr("name");t[s]=r.val()}),t.type=o,t},formMessages:function(e,t,o,r,s){var n,i=a("#"+e).find(".msg-container"),c=rfsfealajax.messages[t][o];switch(r=r,s=s,t){case"ok":n="alert alert-success";break;case"warning":n="alert alert-warning";break;default:n="alert alert-danger"}var l=a("<div></div>",{class:"alert text-center "+n});r?l.html(c):l.text(c),s?i.append(l):i.html(l)},updateFieldsValue:function(e,t){a(e).length&&"object"==a.type(t)&&a.each(t,function(a,t){e.find("#"+a).val(t)})}},routing:function(){function t(e,t,n){-1!=o(e)&&(t&&t.preventDefault(),s.removeClass("active"),a(e).addClass("active"),n&&r(e))}function o(e){return a.inArray(e,i)}function r(a){history.pushState?history.pushState(null,null,a):e.location.hash=a}var s=a(".rfs-feal-page"),n=s.find("a"),i=[];s.each(function(e,t){i.push("#"+a(t).attr("id"))}),"#loggedin"==e.location.hash&&(history.pushState?history.pushState(null,null,e.location.pathname):e.location.hash=""),i.length&&(e.location.hash&&t(e.location.hash,!1,!0),s.hasClass("active")&&""===e.location.hash&&(e.location.hash=s.attr("id")),n.on("click",function(e){t(a(this).attr("href"),e,!0)}),e.onpopstate=function(){t(e.location.hash,!1,!1)})},proccessForms:function(){var t=a(".rfs-feal-form button"),o=!1,s=a(".msg-container"),n=function(a,e,t){switch(a){case"on":t.css("opacity",1),e.attr("disabled",!0),s.html("");break;case"off":t.css("opacity",0),e.attr("disabled",!1)}};t.on("click",function(){if(!o){var t=a(this),s=t.closest("form"),i=r.utils.formData(s),c=s.find(".loader");n("on",t,c);var l={action:"login_profile_actions",nonce:rfsfealajax.feal_nonce,formData:i};a.post(rfsfealajax.ajaxurl,l).done(function(s){switch(s[0]){case"ok":switch(i.type){case"login":e.location.reload();break;case"register":case"remind":r.utils.formMessages(i.type,"ok",s[1]);break;case"setpassword":e.location.replace(s[1]);break;case"profile":if(r.utils.formMessages(i.type,"ok",s[1]),s[2]){r.utils.formMessages(i.type,"warning","password_changed",!0,!0);var l=a(".feal-countdown"),f=5;l.text(f),setInterval(function(){if(0===f)return e.location.reload(),!1;f--,l.text(f)},1e3)}}break;case"error":r.utils.formMessages(i.type,"error",s[1]);break;default:r.utils.formMessages(i.type,"error","error")}"login"==i.type&&"ok"==s[0]||(n("off",t,c),o=!1)}).fail(function(a,e,t){r.utils.formMessages(i.type,"error","error")}),o=!0}})},passwordHint:function(){var e=a("#rfs-feal .password-hint"),t=a("#rfs-feal .password-conditions");e.on("click",function(){t.slideToggle()})},userBar:function(){if(1==rfsfealajax.loggedin&&1==rfsfealajax.show_bar){var e={action:"add_user_bar",nonce:rfsfealajax.feal_nonce};a.post(rfsfealajax.ajaxurl,e,function(e){"ok"==e[0]&&a("body").prepend(e[1])})}}};a(t).ready(function(a){r.proccessForms(),r.routing(),r.passwordHint(),r.userBar()})}(jQuery,window,document);